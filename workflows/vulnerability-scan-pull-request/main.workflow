workflow "Scan PR for vulnerable dependencies" {
  on = "pull_request"
  resolves = ["Vulnerability Scan"]
}

action "Files changed (vulnerability scan)" {
  uses = "actions/bin/filter@d820d56839906464fb7a57d1b4e1741cf5183efa"
  args = "action 'opened|synchronize'"
}

action "Install Dependencies" {
  uses = "actions/npm@v2.0.0"
  needs = "Files changed (vulnerability scan)"
  args = "ci"
}

action "Vulnerability Scan" {
  uses = "actions/vulnerability-scan@v1.0.0"
  needs = "Install Dependencies"
  env = {
    ECOSYSTEM = "npm"
  }
  secrets = ["GITHUB_TOKEN"]
}
